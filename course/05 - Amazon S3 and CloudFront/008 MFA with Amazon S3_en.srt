1
00:00:05,550 --> 00:00:12,600
There are a couple of ways we can use Multi-Factor Authentication with Amazon S3. So, Multi-Factor Authentication

2
00:00:12,600 --> 00:00:17,490
means you have a second factor of authentication above and beyond your password.

3
00:00:17,820 --> 00:00:21,680
So you have a username and password and then you have to supply something else.

4
00:00:21,990 --> 00:00:28,200
And that something else is typically a code that's generated by either a physical device like a token

5
00:00:28,380 --> 00:00:34,140
generating key card or it's actually an app on your phone like Google Authenticator.

6
00:00:35,140 --> 00:00:42,660
So, the first one is Multi-Factor Authentication Delete. This simply adds a requirement for a second factor

7
00:00:42,670 --> 00:00:49,120
of authentication when performing certain operations. That is, changing the versioning state of a bucket

8
00:00:49,330 --> 00:00:51,970
and permanently deleting an object version.

9
00:00:52,690 --> 00:00:58,870
It's important for the exam to remember those two specific operations. And those are the operations

10
00:00:58,870 --> 00:01:03,010
for which the extra requirement for MFA will be enforced.

11
00:01:03,640 --> 00:01:11,290
When you use MFA Delete, the x-amz-mfa requests that it gets included in the requests for those

12
00:01:11,290 --> 00:01:12,610
specific operations.

13
00:01:13,300 --> 00:01:20,170
The second factor of authentication is typically a code that's generated by a hardware device or software

14
00:01:20,170 --> 00:01:23,920
program. And the image here is from Google Authenticator.

15
00:01:24,670 --> 00:01:28,060
Now it does require versioning to be enabled on the bucket.

16
00:01:28,540 --> 00:01:31,540
Versioning can be enabled by bucket owners,

17
00:01:31,960 --> 00:01:40,780
the AWS account that created the bucket, or authorized IAM users. MFA Delete can only be enabled by

18
00:01:40,780 --> 00:01:44,410
the bucket's owner, so that's an important distinction to remember.

19
00:01:45,340 --> 00:01:50,650
The next use of MFA is something called MFA Protected API Access.

20
00:01:51,160 --> 00:01:58,000
This is used to enforce another factor of authentication when accessing AWS resources,

21
00:01:58,360 --> 00:02:06,940
not just this S3, other resources as well using the API or the CLI. It's enforced using the AWS

22
00:02:06,940 --> 00:02:10,600
MultiFactorAuthAge key in a bucket policy.

23
00:02:10,990 --> 00:02:13,420
So you might have a bucket policy that looks like this.

24
00:02:13,930 --> 00:02:22,000
What this does is it denies any principal, any S3 action on a specific resource in this case.

25
00:02:22,000 --> 00:02:25,720
But it could be, you know, broadly across all S3 buckets as well.

26
00:02:26,470 --> 00:02:35,800
And the condition is if the AWS Multi-Factor authentication age true is not set if it's null. And that

27
00:02:35,800 --> 00:02:43,270
particular attribute will be included in your request if you have authenticated using MFA, if you haven't,

28
00:02:43,270 --> 00:02:45,370
then it's going to deny the access.

29
00:02:45,880 --> 00:02:53,470
Now, if you log in to the console with MFA, but then you issue a command via the CLI or the API,

30
00:02:53,740 --> 00:02:54,740
it doesn't matter.

31
00:02:54,760 --> 00:02:58,300
The MFA from the console is completely separate from this.

32
00:02:58,720 --> 00:03:07,240
What this means is you actually have to supply a token from an MFA device to the CLI or API to get

33
00:03:07,240 --> 00:03:12,760
your temporary security credentials, and then you go and issue your API request to S3

34
00:03:12,970 --> 00:03:19,990
and that information gets included. So you must be authenticated with MFA at the command line or the

35
00:03:19,990 --> 00:03:22,120
API rather than through the console.

36
00:03:22,630 --> 00:03:25,180
So I hope that was useful and I'll see you in the next lesson.

